<div class="prices">
  <ul class="block-ul">
    <% @photo_albums.each do |album| -%>
	  <li id="album_<%= album.id %>_photos">
		  <%= link_to album.name, '#', :class => 'prices-cat', 'data-hash-id' => "##{album.id}" %>
		  
			<ul class="block-ul image-list folded extra_width">
        <% album.attachments.each do |photo| -%>
			  <li>
          <%= link_to image_tag(photo.image.url(:site)), photo.image.url, :rel => "<div class=\"addthis_toolbox addthis_default_style\" addthis:url=\"#{single_photo_url(photo.id)}\">
            <a class=\"addthis_button_facebook\"></a>
            <a class=\"addthis_button_vk\"></a>
            <a class=\"addthis_button_compact\"></a>
            <a class=\"addthis_counter addthis_bubble_style\"></a>
          </div>" %>
				</li>
        <% end -%>
      </ul>
		</li>
		<% end -%>
    <!--
    <li >
		  <a class="prices-cat prices-cat-selected">123</a>
		</li>
    -->
	</ul>
</div>

<% content_for :page_javascript do %>
  $(function() {
    $('.image-list a').lightBox({
      afterShow: function() {
        addthis.toolbox(".addthis_toolbox");
      }
    });

    $('.prices-cat').click(function() {
      $(this).next().toggleClass('folded', 200, function () {
        var $li = $(this).closest('li');
        var $a_pc = $li.children('a.prices-cat');

        if(!$(this).hasClass('folded')) {
          $.scrollTo($li, 500, {offset: -50});
          $a_pc.addClass('prices-cat-selected');
          
          window.location.hash = $a_pc.attr('data-hash-id');
        } else {
          $a_pc.removeClass('prices-cat-selected');
        }
      });

      return false;
    });
    
    window.setTimeout(function() {
      if(location.hash != "") {
        var $a_pc = $('a.prices-cat[data-hash-id="'+location.hash+'"]');
        
        $a_pc.click();
      }
    }, 500);
    
  });
<% end %>